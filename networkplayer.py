import json

import httplib, urllib, urllib2

class NetworkPlayer():
    headers = {"Content-type": "application/x-www-form-urlencoded",
               "Accept": "text/plain"}

    def __init__(self, id, port, obj=None, timeout=5000):
        print "player #%s initing with %s" % (id, port)
        self.id = id
        self.port = port
        if(obj):
            self.send_data(obj, timeout)


    def send_data(self, obj, timeout=5000):


        jsonmap = json.dumps(obj);



        #obj = dict(action="turn",
        #      infos={"game_id":"fd7a3378-1feb-11e3-9bdd-9db4cb85f96f","current_turn":1,"maximum_number_of_turns":25,"time_limit_per_turn":5000,"directed":False,"number_of_players":2,"player_id":1},
        #      map={"types":[{"name":"city","points":1,"soldiers_per_turn":1},{"name":"node","points":0,"soldiers_per_turn":0}],"nodes":[{"id":1,"type":"city"},{"id":2,"type":"city"},{"id":3,"type":"city"},{"id":4,"type":"city"},{"id":5,"type":"city"},{"id":6,"type":"city"},{"id":7,"type":"city"},{"id":8,"type":"city"},{"id":9,"type":"city"},{"id":10,"type":"city"},{"id":11,"type":"node"},{"id":12,"type":"node"},{"id":13,"type":"node"},{"id":14,"type":"node"},{"id":15,"type":"node"},{"id":16,"type":"node"},{"id":17,"type":"node"},{"id":18,"type":"node"},{"id":19,"type":"node"},{"id":20,"type":"node"},{"id":21,"type":"node"},{"id":22,"type":"node"},{"id":23,"type":"node"},{"id":24,"type":"node"},{"id":25,"type":"node"},{"id":26,"type":"node"},{"id":27,"type":"node"},{"id":28,"type":"node"}],"paths":[{"from":7,"to":12},{"from":7,"to":13},{"from":12,"to":13},{"from":11,"to":12},{"from":13,"to":15},{"from":8,"to":15},{"from":6,"to":11},{"from":6,"to":14},{"from":5,"to":14},{"from":5,"to":17},{"from":14,"to":17},{"from":14,"to":18},{"from":12,"to":16},{"from":16,"to":18},{"from":1,"to":16},{"from":1,"to":19},{"from":15,"to":19},{"from":8,"to":20},{"from":19,"to":21},{"from":2,"to":18},{"from":4,"to":17},{"from":17,"to":22},{"from":22,"to":25},{"from":4,"to":22},{"from":22,"to":23},{"from":2,"to":23},{"from":23,"to":24},{"from":10,"to":25},{"from":10,"to":28},{"from":3,"to":21},{"from":3,"to":24},{"from":24,"to":28},{"from":27,"to":28},{"from":21,"to":26},{"from":20,"to":26},{"from":26,"to":27},{"from":9,"to":26},{"from":9,"to":27}]},
        #      state=[{"node_id":1,"player_id":0,"number_of_soldiers":5},{"node_id":2,"player_id":None,"number_of_soldiers":0},{"node_id":3,"player_id":None,"number_of_soldiers":0},{"node_id":4,"player_id":1,"number_of_soldiers":5},{"node_id":5,"player_id":None,"number_of_soldiers":0},{"node_id":6,"player_id":None,"number_of_soldiers":0},{"node_id":7,"player_id":None,"number_of_soldiers":0},{"node_id":8,"player_id":None,"number_of_soldiers":0},{"node_id":9,"player_id":None,"number_of_soldiers":0},{"node_id":10,"player_id":None,"number_of_soldiers":0},{"node_id":11,"player_id":None,"number_of_soldiers":0},{"node_id":12,"player_id":None,"number_of_soldiers":0},{"node_id":13,"player_id":None,"number_of_soldiers":0},{"node_id":14,"player_id":None,"number_of_soldiers":0},{"node_id":15,"player_id":None,"number_of_soldiers":0},{"node_id":16,"player_id":None,"number_of_soldiers":0},{"node_id":17,"player_id":None,"number_of_soldiers":0},{"node_id":18,"player_id":None,"number_of_soldiers":0},{"node_id":19,"player_id":None,"number_of_soldiers":0},{"node_id":20,"player_id":None,"number_of_soldiers":0},{"node_id":21,"player_id":None,"number_of_soldiers":0},{"node_id":22,"player_id":None,"number_of_soldiers":0},{"node_id":23,"player_id":None,"number_of_soldiers":0},{"node_id":24,"player_id":None,"number_of_soldiers":0},{"node_id":25,"player_id":None,"number_of_soldiers":0},{"node_id":26,"player_id":None,"number_of_soldiers":0},{"node_id":27,"player_id":None,"number_of_soldiers":0},{"node_id":28,"player_id":None,"number_of_soldiers":0}])




        #PUTS IN DATA
        #try:
        #    req = urllib2.Request("http://127.0.0.1:"+self.port)
        #    req.add_data(jsonmap)
        #    req.add_header('Content-Type', 'application/json')
###
        #    response = urllib2.urlopen(req, timeout=(timeout/1000))
        #    ret = json.load(response)
        #except:
        #    print "failed to load json from %s on port %s " % (self.id, self.port)
        #    return
#


        #PUTS IT IN ARGS - switch to otehr encoder
        # import ipdb; ipdb.set_trace();
        try:
            req = urllib2.Request("http://127.0.0.1:"+self.port+"?"+urllib.urlencode(obj).replace('+', ''))
            req.add_header('Content-Type', 'application/json')
            req.get_method = lambda: 'POST'
            response = urllib2.urlopen(req, timeout=(timeout/1000))
            ret = json.load(response)
        except:
            print "failed to load json from %s on port %s " % (self.id, self.port)
            return


        #PUTS IT IN FORM DATA
        #try:
        #    req = urllib2.Request("http://127.0.0.1:"+self.port)
        #    req.add_header('Content-Type', 'application/json')

        #    response = urllib2.urlopen(req, jsonmap, timeout=(timeout/1000))
        #    ret = json.load(response)
        #except:
        #    print "failed to load json from %s on port %s " % (self.id, self.port)
        #    return

        #conn = httplib.HTTPConnection("127.0.0.1", int(self.port), timeout=(timeout/1000))
        #conn.request("POST", "/", jsonmap, self.headers)
        #resp = conn.getresponse()
        #obj = json.load(resp)

        return ret;
        #                                                                                                                                                                                                                                                                   map=%7B%22types%22%3A%5B%7B%22name%22%3A%22node%22%2C%22points%22%3A0%2C%22soldiers_per_turn%22%3A1%2C%22points%22%3A1%2C%22name%22%3A%22city%22%7D%2C%7B%22soldiers_per_turn%22%3A0%7D%5D%2C%22nodes%22%3A%5B%7B%22type%22%3A%22city%22%2C%22id%22%3A1%7D%2C%7B%22type%22%3A%22city%22%2C%22id
        #/?action=turn&infos=%7B%22game_id%22%3A%22fd7a3378-1feb-11e3-9bdd-9db4cb85f96f%22%2C%22current_turn%22%3A1%2C%22maximum_number_of_turns%22%3A25%2C%22time_limit_per_turn%22%3A5000%2C%22directed%22%3Afalse%2C%22number_of_players%22%3A2%2C%22player_id%22%3A1%7D&map=%7B%22types%22%3A%5B%7B%22name%22%3A%22city%22%2C%22points%22%3A1%2C%22soldiers_per_turn%22%3A1%7D%2C%7B%22name%22%3A%22node%22%2C%22points%22%3A0%2C%22soldiers_per_turn%22%3A0%7D%5D%2C%22nodes%22%3A%5B%7B%22id%22%3A1%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A2%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A3%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A4%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A5%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A6%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A7%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A8%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A9%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A10%2C%22type%22%3A%22city%22%7D%2C%7B%22id%22%3A11%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A12%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A13%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A14%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A15%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A16%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A17%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A18%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A19%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A20%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A21%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A22%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A23%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A24%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A25%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A26%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A27%2C%22type%22%3A%22node%22%7D%2C%7B%22id%22%3A28%2C%22type%22%3A%22node%22%7D%5D%2C%22paths%22%3A%5B%7B%22from%22%3A7%2C%22to%22%3A12%7D%2C%7B%22from%22%3A7%2C%22to%22%3A13%7D%2C%7B%22from%22%3A12%2C%22to%22%3A13%7D%2C%7B%22from%22%3A11%2C%22to%22%3A12%7D%2C%7B%22from%22%3A13%2C%22to%22%3A15%7D%2C%7B%22from%22%3A8%2C%22to%22%3A15%7D%2C%7B%22from%22%3A6%2C%22to%22%3A11%7D%2C%7B%22from%22%3A6%2C%22to%22%3A14%7D%2C%7B%22from%22%3A5%2C%22to%22%3A14%7D%2C%7B%22from%22%3A5%2C%22to%22%3A17%7D%2C%7B%22from%22%3A14%2C%22to%22%3A17%7D%2C%7B%22from%22%3A14%2C%22to%22%3A18%7D%2C%7B%22from%22%3A12%2C%22to%22%3A16%7D%2C%7B%22from%22%3A16%2C%22to%22%3A18%7D%2C%7B%22from%22%3A1%2C%22to%22%3A16%7D%2C%7B%22from%22%3A1%2C%22to%22%3A19%7D%2C%7B%22from%22%3A15%2C%22to%22%3A19%7D%2C%7B%22from%22%3A8%2C%22to%22%3A20%7D%2C%7B%22from%22%3A19%2C%22to%22%3A21%7D%2C%7B%22from%22%3A2%2C%22to%22%3A18%7D%2C%7B%22from%22%3A4%2C%22to%22%3A17%7D%2C%7B%22from%22%3A17%2C%22to%22%3A22%7D%2C%7B%22from%22%3A22%2C%22to%22%3A25%7D%2C%7B%22from%22%3A4%2C%22to%22%3A22%7D%2C%7B%22from%22%3A22%2C%22to%22%3A23%7D%2C%7B%22from%22%3A2%2C%22to%22%3A23%7D%2C%7B%22from%22%3A23%2C%22to%22%3A24%7D%2C%7B%22from%22%3A10%2C%22to%22%3A25%7D%2C%7B%22from%22%3A10%2C%22to%22%3A28%7D%2C%7B%22from%22%3A3%2C%22to%22%3A21%7D%2C%7B%22from%22%3A3%2C%22to%22%3A24%7D%2C%7B%22from%22%3A24%2C%22to%22%3A28%7D%2C%7B%22from%22%3A27%2C%22to%22%3A28%7D%2C%7B%22from%22%3A21%2C%22to%22%3A26%7D%2C%7B%22from%22%3A20%2C%22to%22%3A26%7D%2C%7B%22from%22%3A26%2C%22to%22%3A27%7D%2C%7B%22from%22%3A9%2C%22to%22%3A26%7D%2C%7B%22from%22%3A9%2C%22to%22%3A27%7D%5D%7D&state=%5B%7B%22node_id%22%3A1%2C%22player_id%22%3A0%2C%22number_of_soldiers%22%3A5%7D%2C%7B%22node_id%22%3A2%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A3%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A4%2C%22player_id%22%3A1%2C%22number_of_soldiers%22%3A5%7D%2C%7B%22node_id%22%3A5%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A6%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A7%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A8%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A9%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A10%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A11%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A12%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A13%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A14%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A15%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A16%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A17%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A18%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A19%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A20%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A21%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A22%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A23%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A24%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A25%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A26%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A27%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22node_id%22%3A28%2C%22player_id%22%3Anull%2C%22number_of_soldiers%22%3A0%7D%5D
        #?action=%27turn%27&map=%7B%27paths%27%3A+%5B%7B%27to%27%3A+12%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+7%7D%2C+%7B%27to%27%3A+13%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+7%7D%2C+%7B%27to%27%3A+13%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+12%7D%2C+%7B%27to%27%3A+12%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+11%7D%2C+%7B%27to%27%3A+15%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+13%7D%2C+%7B%27to%27%3A+15%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+8%7D%2C+%7B%27to%27%3A+11%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+6%7D%2C+%7B%27to%27%3A+14%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+6%7D%2C+%7B%27to%27%3A+14%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+5%7D%2C+%7B%27to%27%3A+17%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+5%7D%2C+%7B%27to%27%3A+17%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+14%7D%2C+%7B%27to%27%3A+18%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+14%7D%2C+%7B%27to%27%3A+16%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+12%7D%2C+%7B%27to%27%3A+18%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+16%7D%2C+%7B%27to%27%3A+16%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+1%7D%2C+%7B%27to%27%3A+19%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+1%7D%2C+%7B%27to%27%3A+19%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+15%7D%2C+%7B%27to%27%3A+20%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+8%7D%2C+%7B%27to%27%3A+21%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+19%7D%2C+%7B%27to%27%3A+18%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+2%7D%2C+%7B%27to%27%3A+17%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+4%7D%2C+%7B%27to%27%3A+22%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+17%7D%2C+%7B%27to%27%3A+25%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+22%7D%2C+%7B%27to%27%3A+22%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+4%7D%2C+%7B%27to%27%3A+23%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+22%7D%2C+%7B%27to%27%3A+23%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+2%7D%2C+%7B%27to%27%3A+24%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+23%7D%2C+%7B%27to%27%3A+25%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+10%7D%2C+%7B%27to%27%3A+28%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+10%7D%2C+%7B%27to%27%3A+21%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+3%7D%2C+%7B%27to%27%3A+24%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+3%7D%2C+%7B%27to%27%3A+28%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+24%7D%2C+%7B%27to%27%3A+28%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+27%7D%2C+%7B%27to%27%3A+26%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+21%7D%2C+%7B%27to%27%3A+26%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+20%7D%2C+%7B%27to%27%3A+27%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+26%7D%2C+%7B%27to%27%3A+26%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+9%7D%2C+%7B%27to%27%3A+27%2C+%27control_ratio%27%3A+0.3%2C+%27from%27%3A+9%7D%5D%2C+%27nodes%27%3A+%5B%7B%27y%27%3A+34%2C+%27x%27%3A+48%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+1%7D%2C+%7B%27y%27%3A+47%2C+%27x%27%3A+56%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+2%7D%2C+%7B%27y%27%3A+50%2C+%27x%27%3A+46%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+3%7D%2C+%7B%27y%27%3A+39%2C+%27x%27%3A+79%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+4%7D%2C+%7B%27y%27%3A+9%2C+%27x%27%3A+73%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+5%7D%2C+%7B%27y%27%3A+7%2C+%27x%27%3A+61%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+6%7D%2C+%7B%27y%27%3A+6%2C+%27x%27%3A+36%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+7%7D%2C+%7B%27y%27%3A+40%2C+%27x%27%3A+26%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+8%7D%2C+%7B%27y%27%3A+88%2C+%27x%27%3A+36%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+9%7D%2C+%7B%27y%27%3A+79%2C+%27x%27%3A+64%2C+%27type%27%3A+%27city%27%2C+%27id%27%3A+10%7D%2C+%7B%27y%27%3A+4%2C+%27x%27%3A+54%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+11%7D%2C+%7B%27y%27%3A+10%2C+%27x%27%3A+48%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+12%7D%2C+%7B%27y%27%3A+15%2C+%27x%27%3A+41%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+13%7D%2C+%7B%27y%27%3A+16%2C+%27x%27%3A+64%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+14%7D%2C+%7B%27y%27%3A+25%2C+%27x%27%3A+35%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+15%7D%2C+%7B%27y%27%3A+25%2C+%27x%27%3A+53%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+16%7D%2C+%7B%27y%27%3A+27%2C+%27x%27%3A+71%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+17%7D%2C+%7B%27y%27%3A+31%2C+%27x%27%3A+57%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+18%7D%2C+%7B%27y%27%3A+40%2C+%27x%27%3A+36%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+19%7D%2C+%7B%27y%27%3A+51%2C+%27x%27%3A+30%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+20%7D%2C+%7B%27y%27%3A+50%2C+%27x%27%3A+39%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+21%7D%2C+%7B%27y%27%3A+47%2C+%27x%27%3A+70%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+22%7D%2C+%7B%27y%27%3A+59%2C+%27x%27%3A+57%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+23%7D%2C+%7B%27y%27%3A+63%2C+%27x%27%3A+50%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+24%7D%2C+%7B%27y%27%3A+63%2C+%27x%27%3A+69%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+25%7D%2C+%7B%27y%27%3A+71%2C+%27x%27%3A+40%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+26%7D%2C+%7B%27y%27%3A+78%2C+%27x%27%3A+47%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+27%7D%2C+%7B%27y%27%3A+80%2C+%27x%27%3A+54%2C+%27type%27%3A+%27node%27%2C+%27id%27%3A+28%7D%5D%2C+%27types%27%3A+%5B%7B%27soldiers_per_turn%27%3A+1%2C+%27points%27%3A+1%2C+%27name%27%3A+%27city%27%7D%2C+%7B%27soldiers_per_turn%27%3A+0%2C+%27points%27%3A+0%2C+%27name%27%3A+%27node%27%7D%5D%7D&infos=%7B%27directed%27%3A+false%2C+%27number_of_players%27%3A+%5B2%5D%2C+%27name%27%3A+%27Map+to+test+new+layout%27%2C+%27maximum_number_of_turns%27%3A+25%2C+%27player_id%27%3A+1%2C+%27version%27%3A+1%2C+%27tile_background%27%3A+false%2C+%27time_limit_per_turn%27%3A+5000%2C+%27translate%27%3A+%7B%27y%27%3A+20%2C+%27x%27%3A+0%7D%7D&state=%5B%7B%27player_id%27%3A+0%2C+%27node_id%27%3A+1%2C+%27number_of_soldiers%27%3A+6%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+2%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+3%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+1%2C+%27node_id%27%3A+4%2C+%27number_of_soldiers%27%3A+6%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+5%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+6%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+7%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+8%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+9%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+10%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+11%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+12%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+13%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+14%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+15%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+16%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+17%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+18%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+19%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+20%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+21%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+22%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+23%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+24%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+25%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+26%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+27%2C+%27number_of_soldiers%27%3A+0%7D%2C+%7B%27player_id%27%3A+null%2C+%27node_id%27%3A+28%2C+%27number_of_soldiers%27%3A+0%7D%5D


        #/?action=turn&map=%7B%22paths%22%3A%5B%7B%22to%22%3A12%2C%22from%22%3A7%7D%2C%7B%22to%22%3A13%2C%22from%22%3A7%7D%2C%7B%22to%22%3A13%2C%22from%22%3A12%7D%2C%7B%22to%22%3A12%2C%22from%22%3A11%7D%2C%7B%22to%22%3A15%2C%22from%22%3A13%7D%2C%7B%22to%22%3A15%2C%22from%22%3A8%7D%2C%7B%22to%22%3A11%2C%22from%22%3A6%7D%2C%7B%22to%22%3A14%2C%22from%22%3A6%7D%2C%7B%22to%22%3A14%2C%22from%22%3A5%7D%2C%7B%22to%22%3A17%2C%22from%22%3A5%7D%2C%7B%22to%22%3A17%2C%22from%22%3A14%7D%2C%7B%22to%22%3A18%2C%22from%22%3A14%7D%2C%7B%22to%22%3A16%2C%22from%22%3A12%7D%2C%7B%22to%22%3A18%2C%22from%22%3A16%7D%2C%7B%22to%22%3A16%2C%22from%22%3A1%7D%2C%7B%22to%22%3A19%2C%22from%22%3A1%7D%2C%7B%22to%22%3A19%2C%22from%22%3A15%7D%2C%7B%22to%22%3A20%2C%22from%22%3A8%7D%2C%7B%22to%22%3A21%2C%22from%22%3A19%7D%2C%7B%22to%22%3A18%2C%22from%22%3A2%7D%2C%7B%22to%22%3A17%2C%22from%22%3A4%7D%2C%7B%22to%22%3A22%2C%22from%22%3A17%7D%2C%7B%22to%22%3A25%2C%22from%22%3A22%7D%2C%7B%22to%22%3A22%2C%22from%22%3A4%7D%2C%7B%22to%22%3A23%2C%22from%22%3A22%7D%2C%7B%22to%22%3A23%2C%22from%22%3A2%7D%2C%7B%22to%22%3A24%2C%22from%22%3A23%7D%2C%7B%22to%22%3A25%2C%22from%22%3A10%7D%2C%7B%22to%22%3A28%2C%22from%22%3A10%7D%2C%7B%22to%22%3A21%2C%22from%22%3A3%7D%2C%7B%22to%22%3A24%2C%22from%22%3A3%7D%2C%7B%22to%22%3A28%2C%22from%22%3A24%7D%2C%7B%22to%22%3A28%2C%22from%22%3A27%7D%2C%7B%22to%22%3A26%2C%22from%22%3A21%7D%2C%7B%22to%22%3A26%2C%22from%22%3A20%7D%2C%7B%22to%22%3A27%2C%22from%22%3A26%7D%2C%7B%22to%22%3A26%2C%22from%22%3A9%7D%2C%7B%22to%22%3A27%2C%22from%22%3A9%7D%5D%2C%22nodes%22%3A%5B%7B%22type%22%3A%22city%22%2C%22id%22%3A1%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A2%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A3%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A4%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A5%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A6%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A7%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A8%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A9%7D%2C%7B%22type%22%3A%22city%22%2C%22id%22%3A10%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A11%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A12%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A13%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A14%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A15%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A16%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A17%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A18%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A19%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A20%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A21%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A22%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A23%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A24%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A25%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A26%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A27%7D%2C%7B%22type%22%3A%22node%22%2C%22id%22%3A28%7D%5D%2C%22types%22%3A%5B%7B%22soldiers_per_turn%22%3A1%2C%22points%22%3A1%2C%22name%22%3A%22city%22%7D%2C%7B%22soldiers_per_turn%22%3A0%2C%22points%22%3A0%2C%22name%22%3A%22node%22%7D%5D%7D&state=%5B%7B%22player_id%22%3A0%2C%22node_id%22%3A1%2C%22number_of_soldiers%22%3A5%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A2%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A3%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3A1%2C%22node_id%22%3A4%2C%22number_of_soldiers%22%3A5%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A5%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A6%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A7%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A8%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A9%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A10%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A11%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A12%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A13%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A14%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A15%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A16%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A17%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A18%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A19%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A20%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A21%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A22%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A23%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A24%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A25%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A26%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A27%2C%22number_of_soldiers%22%3A0%7D%2C%7B%22player_id%22%3Anull%2C%22node_id%22%3A28%2C%22number_of_soldiers%22%3A0%7D%5D&infos=%7B%22directed%22%3Afalse%2C%22number_of_players%22%3A2%2C%22current_turn%22%3A1%2C%22time_limit_per_tu









